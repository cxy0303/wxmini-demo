{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["/**\n * Copyright(c) dead_horse and other contributors.\n * MIT Licensed\n *\n * Authors:\n * \t dead_horse <dead_horse@qq.com>\n *   fengmk2 <fengmk2@gmail.com> (http://fengmk2.com)\n */\n\n\n\n/**\n * Module dependencies.\n */\n\nvar ready = require('get-ready');\nvar EventEmitter = require('events').EventEmitter;\nvar util = require('util');\n\nmodule.exports = Base;\n\nfunction Base() {\n  EventEmitter.call(this);\n  this.on('error', this.defaultErrorHandler.bind(this));\n}\n\n/**\n * inherits from EventEmitter\n */\n\nutil.inherits(Base, EventEmitter);\n\nready.mixin(Base.prototype);\n\nBase.prototype.defaultErrorHandler = function (err) {\n  if (this.listeners('error').length > 1) {\n    // ignore defaultErrorHandler\n    return;\n  }\n  console.error('\\n[%s][pid: %s][%s][%s] %s: %s \\nError Stack:\\n  %s',\n    Date(), process.pid, this.constructor.name, __filename, err.name,\n    err.message, err.stack);\n\n  // try to show addition property on the error object\n  // e.g.: `err.data = {url: '/foo'};`\n  var additions = [];\n  for (var key in err) {\n    if (key === 'name' || key === 'message') {\n      continue;\n    }\n\n    additions.push(util.format('  %s: %j', key, err[key]));\n  }\n  if (additions.length) {\n    console.error('Error Additions:\\n%s', additions.join('\\n'));\n  }\n  console.error();\n};\n"]}